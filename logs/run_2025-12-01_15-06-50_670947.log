2025-12-01 15:06:50.677 | INFO     | __main__:main:62 - === Program started ===
2025-12-01 15:06:50.678 | INFO     | __main__:run_func:15 - run_func started with date range 2025-06-01 → 2025-06-11
2025-12-01 15:06:50.679 | DEBUG    | __main__:run_func:16 - JSON Path 1: /app/json_files/fb_spend.json
2025-12-01 15:06:50.680 | DEBUG    | __main__:run_func:17 - JSON Path 2: /app/json_files/network_conv.json
2025-12-01 15:06:50.681 | DEBUG    | utils.utils:read_json_file:15 - Reading JSON file: /app/json_files/fb_spend.json
2025-12-01 15:06:50.684 | INFO     | utils.utils:read_json_file:19 - Loaded JSON file successfully: /app/json_files/fb_spend.json, records=5
2025-12-01 15:06:50.686 | DEBUG    | utils.utils:read_json_file:15 - Reading JSON file: /app/json_files/network_conv.json
2025-12-01 15:06:50.688 | INFO     | utils.utils:read_json_file:19 - Loaded JSON file successfully: /app/json_files/network_conv.json, records=5
2025-12-01 15:06:50.690 | INFO     | __main__:run_func:22 - Loaded JSON files: old_json=5, incoming_json=5
2025-12-01 15:06:50.691 | DEBUG    | utils.utils:get_days_intervals:50 - Filtering records between 2025-06-01 and 2025-06-11
2025-12-01 15:06:50.692 | INFO     | utils.utils:get_days_intervals:59 - Filtered 5 records in date range 2025-06-01 → 2025-06-11
2025-12-01 15:06:50.693 | DEBUG    | utils.utils:get_days_intervals:50 - Filtering records between 2025-06-01 and 2025-06-11
2025-12-01 15:06:50.694 | INFO     | utils.utils:get_days_intervals:59 - Filtered 5 records in date range 2025-06-01 → 2025-06-11
2025-12-01 15:06:50.695 | INFO     | __main__:run_func:26 - Filtered records: spend=5, conversions=5
2025-12-01 15:06:50.698 | DEBUG    | __main__:run_func:30 - DataFrames created
2025-12-01 15:06:50.703 | INFO     | __main__:run_func:38 - Merged dataframe size: 7
2025-12-01 15:06:50.705 | DEBUG    | __main__:run_func:44 - CPA calculation completed
2025-12-01 15:06:50.707 | DEBUG    | utils.utils:nan_to_none:69 - Converted NaN → None
2025-12-01 15:06:50.708 | DEBUG    | utils.utils:nan_to_none:69 - Converted NaN → None
2025-12-01 15:06:50.709 | DEBUG    | utils.utils:nan_to_none:69 - Converted NaN → None
2025-12-01 15:06:50.710 | DEBUG    | utils.utils:nan_to_none:69 - Converted NaN → None
2025-12-01 15:06:50.711 | DEBUG    | utils.utils:nan_to_none:69 - Converted NaN → None
2025-12-01 15:06:50.712 | DEBUG    | utils.utils:nan_to_none:69 - Converted NaN → None
2025-12-01 15:06:50.712 | DEBUG    | utils.utils:nan_to_none:69 - Converted NaN → None
2025-12-01 15:06:50.713 | DEBUG    | utils.utils:nan_to_none:69 - Converted NaN → None
2025-12-01 15:06:50.714 | INFO     | __main__:run_func:53 - Prepared final records: 7
2025-12-01 15:06:50.715 | INFO     | __main__:main:72 - Total records to upsert: 7
2025-12-01 15:06:50.717 | DEBUG    | __main__:main:76 - Upserting record: {'date': '2025-06-04', 'campaign_id': 'CAMP-123', 'spend': 37.5, 'conversions': 14, 'CPA': 2.68}
2025-12-01 15:06:50.717 | DEBUG    | handler_DB.operations:upsert:40 - Upsert called with data: {'date': '2025-06-04', 'campaign_id': 'CAMP-123', 'spend': 37.5, 'conversions': 14, 'CPA': 2.68}
2025-12-01 15:06:50.726 | INFO     | handler_DB.operations:upsert:57 - Upsert successful [date=2025-06-04, campaign_id=CAMP-123]
2025-12-01 15:06:50.727 | DEBUG    | __main__:main:76 - Upserting record: {'date': '2025-06-04', 'campaign_id': 'CAMP-456', 'spend': 19.9, 'conversions': 3, 'CPA': 6.63}
2025-12-01 15:06:50.728 | DEBUG    | handler_DB.operations:upsert:40 - Upsert called with data: {'date': '2025-06-04', 'campaign_id': 'CAMP-456', 'spend': 19.9, 'conversions': 3, 'CPA': 6.63}
2025-12-01 15:06:50.737 | INFO     | handler_DB.operations:upsert:57 - Upsert successful [date=2025-06-04, campaign_id=CAMP-456]
2025-12-01 15:06:50.738 | DEBUG    | __main__:main:76 - Upserting record: {'date': '2025-06-05', 'campaign_id': 'CAMP-123', 'spend': 42.1, 'conversions': 10, 'CPA': 4.21}
2025-12-01 15:06:50.739 | DEBUG    | handler_DB.operations:upsert:40 - Upsert called with data: {'date': '2025-06-05', 'campaign_id': 'CAMP-123', 'spend': 42.1, 'conversions': 10, 'CPA': 4.21}
2025-12-01 15:06:50.748 | INFO     | handler_DB.operations:upsert:57 - Upsert successful [date=2025-06-05, campaign_id=CAMP-123]
2025-12-01 15:06:50.749 | DEBUG    | __main__:main:76 - Upserting record: {'date': '2025-06-05', 'campaign_id': 'CAMP-456', 'spend': None, 'conversions': 5, 'CPA': None}
2025-12-01 15:06:50.750 | DEBUG    | handler_DB.operations:upsert:40 - Upsert called with data: {'date': '2025-06-05', 'campaign_id': 'CAMP-456', 'spend': None, 'conversions': 5, 'CPA': None}
2025-12-01 15:06:50.759 | INFO     | handler_DB.operations:upsert:57 - Upsert successful [date=2025-06-05, campaign_id=CAMP-456]
2025-12-01 15:06:50.760 | DEBUG    | __main__:main:76 - Upserting record: {'date': '2025-06-05', 'campaign_id': 'CAMP-789', 'spend': 11, 'conversions': None, 'CPA': None}
2025-12-01 15:06:50.761 | DEBUG    | handler_DB.operations:upsert:40 - Upsert called with data: {'date': '2025-06-05', 'campaign_id': 'CAMP-789', 'spend': 11, 'conversions': None, 'CPA': None}
2025-12-01 15:06:50.770 | INFO     | handler_DB.operations:upsert:57 - Upsert successful [date=2025-06-05, campaign_id=CAMP-789]
2025-12-01 15:06:50.771 | DEBUG    | __main__:main:76 - Upserting record: {'date': '2025-06-06', 'campaign_id': 'CAMP-888', 'spend': None, 'conversions': 7, 'CPA': None}
2025-12-01 15:06:50.772 | DEBUG    | handler_DB.operations:upsert:40 - Upsert called with data: {'date': '2025-06-06', 'campaign_id': 'CAMP-888', 'spend': None, 'conversions': 7, 'CPA': None}
2025-12-01 15:06:50.784 | INFO     | handler_DB.operations:upsert:57 - Upsert successful [date=2025-06-06, campaign_id=CAMP-888]
2025-12-01 15:06:50.786 | DEBUG    | __main__:main:76 - Upserting record: {'date': '2025-06-06', 'campaign_id': 'CAMP-999', 'spend': 5.25, 'conversions': None, 'CPA': None}
2025-12-01 15:06:50.786 | DEBUG    | handler_DB.operations:upsert:40 - Upsert called with data: {'date': '2025-06-06', 'campaign_id': 'CAMP-999', 'spend': 5.25, 'conversions': None, 'CPA': None}
2025-12-01 15:06:50.795 | INFO     | handler_DB.operations:upsert:57 - Upsert successful [date=2025-06-06, campaign_id=CAMP-999]
2025-12-01 15:06:50.796 | DEBUG    | handler_DB.operations:query_by_date:68 - Querying daily_stats for date: 2025-06-04 00:00:00
2025-12-01 15:06:50.802 | INFO     | handler_DB.operations:query_by_date:72 - Found 2 records for date 2025-06-04 00:00:00
2025-12-01 15:06:50.803 | INFO     | __main__:main:84 - === Program finished successfully ===
