2025-12-01 15:06:02.295 | INFO     | handler_DB.settings.settings:<module>:23 - Connecting to database: postgresql://postgres:denis2004@db:5432/SalesBrush
2025-12-01 15:06:02.353 | SUCCESS  | handler_DB.settings.settings:<module>:27 - Database engine created successfully
2025-12-01 15:06:02.415 | SUCCESS  | handler_DB.settings.settings:<module>:34 - Database tables created or already exist
2025-12-01 15:06:02.416 | SUCCESS  | handler_DB.settings.settings:<module>:41 - SessionLocal configured successfully
2025-12-01 15:06:02.468 | INFO     | __main__:main:62 - === Program started ===
2025-12-01 15:06:02.470 | INFO     | __main__:run_func:15 - run_func started with date range 2025-06-01 → 2025-06-11
2025-12-01 15:06:02.471 | DEBUG    | __main__:run_func:16 - JSON Path 1: /app/json_files/fb_spend.json
2025-12-01 15:06:02.472 | DEBUG    | __main__:run_func:17 - JSON Path 2: /app/json_files/network_conv.json
2025-12-01 15:06:02.473 | DEBUG    | utils.utils:read_json_file:15 - Reading JSON file: /app/json_files/fb_spend.json
2025-12-01 15:06:02.476 | INFO     | utils.utils:read_json_file:19 - Loaded JSON file successfully: /app/json_files/fb_spend.json, records=5
2025-12-01 15:06:02.478 | DEBUG    | utils.utils:read_json_file:15 - Reading JSON file: /app/json_files/network_conv.json
2025-12-01 15:06:02.481 | INFO     | utils.utils:read_json_file:19 - Loaded JSON file successfully: /app/json_files/network_conv.json, records=5
2025-12-01 15:06:02.482 | INFO     | __main__:run_func:22 - Loaded JSON files: old_json=5, incoming_json=5
2025-12-01 15:06:02.483 | DEBUG    | utils.utils:get_days_intervals:50 - Filtering records between 2025-06-01 and 2025-06-11
2025-12-01 15:06:02.485 | INFO     | utils.utils:get_days_intervals:59 - Filtered 5 records in date range 2025-06-01 → 2025-06-11
2025-12-01 15:06:02.486 | DEBUG    | utils.utils:get_days_intervals:50 - Filtering records between 2025-06-01 and 2025-06-11
2025-12-01 15:06:02.487 | INFO     | utils.utils:get_days_intervals:59 - Filtered 5 records in date range 2025-06-01 → 2025-06-11
2025-12-01 15:06:02.488 | INFO     | __main__:run_func:26 - Filtered records: spend=5, conversions=5
2025-12-01 15:06:02.491 | DEBUG    | __main__:run_func:30 - DataFrames created
2025-12-01 15:06:02.500 | INFO     | __main__:run_func:38 - Merged dataframe size: 7
2025-12-01 15:06:02.502 | DEBUG    | __main__:run_func:44 - CPA calculation completed
2025-12-01 15:06:02.505 | DEBUG    | utils.utils:nan_to_none:69 - Converted NaN → None
2025-12-01 15:06:02.506 | DEBUG    | utils.utils:nan_to_none:69 - Converted NaN → None
2025-12-01 15:06:02.507 | DEBUG    | utils.utils:nan_to_none:69 - Converted NaN → None
2025-12-01 15:06:02.508 | DEBUG    | utils.utils:nan_to_none:69 - Converted NaN → None
2025-12-01 15:06:02.509 | DEBUG    | utils.utils:nan_to_none:69 - Converted NaN → None
2025-12-01 15:06:02.509 | DEBUG    | utils.utils:nan_to_none:69 - Converted NaN → None
2025-12-01 15:06:02.510 | DEBUG    | utils.utils:nan_to_none:69 - Converted NaN → None
2025-12-01 15:06:02.511 | DEBUG    | utils.utils:nan_to_none:69 - Converted NaN → None
2025-12-01 15:06:02.512 | INFO     | __main__:run_func:53 - Prepared final records: 7
2025-12-01 15:06:02.513 | INFO     | __main__:main:72 - Total records to upsert: 7
2025-12-01 15:06:02.515 | DEBUG    | __main__:main:76 - Upserting record: {'date': '2025-06-04', 'campaign_id': 'CAMP-123', 'spend': 37.5, 'conversions': 14, 'CPA': 2.68}
2025-12-01 15:06:02.516 | DEBUG    | handler_DB.operations:upsert:40 - Upsert called with data: {'date': '2025-06-04', 'campaign_id': 'CAMP-123', 'spend': 37.5, 'conversions': 14, 'CPA': 2.68}
2025-12-01 15:06:02.530 | INFO     | handler_DB.operations:upsert:57 - Upsert successful [date=2025-06-04, campaign_id=CAMP-123]
2025-12-01 15:06:02.531 | DEBUG    | __main__:main:76 - Upserting record: {'date': '2025-06-04', 'campaign_id': 'CAMP-456', 'spend': 19.9, 'conversions': 3, 'CPA': 6.63}
2025-12-01 15:06:02.532 | DEBUG    | handler_DB.operations:upsert:40 - Upsert called with data: {'date': '2025-06-04', 'campaign_id': 'CAMP-456', 'spend': 19.9, 'conversions': 3, 'CPA': 6.63}
2025-12-01 15:06:02.541 | INFO     | handler_DB.operations:upsert:57 - Upsert successful [date=2025-06-04, campaign_id=CAMP-456]
2025-12-01 15:06:02.543 | DEBUG    | __main__:main:76 - Upserting record: {'date': '2025-06-05', 'campaign_id': 'CAMP-123', 'spend': 42.1, 'conversions': 10, 'CPA': 4.21}
2025-12-01 15:06:02.543 | DEBUG    | handler_DB.operations:upsert:40 - Upsert called with data: {'date': '2025-06-05', 'campaign_id': 'CAMP-123', 'spend': 42.1, 'conversions': 10, 'CPA': 4.21}
2025-12-01 15:06:02.553 | INFO     | handler_DB.operations:upsert:57 - Upsert successful [date=2025-06-05, campaign_id=CAMP-123]
2025-12-01 15:06:02.555 | DEBUG    | __main__:main:76 - Upserting record: {'date': '2025-06-05', 'campaign_id': 'CAMP-456', 'spend': None, 'conversions': 5, 'CPA': None}
2025-12-01 15:06:02.556 | DEBUG    | handler_DB.operations:upsert:40 - Upsert called with data: {'date': '2025-06-05', 'campaign_id': 'CAMP-456', 'spend': None, 'conversions': 5, 'CPA': None}
2025-12-01 15:06:02.565 | INFO     | handler_DB.operations:upsert:57 - Upsert successful [date=2025-06-05, campaign_id=CAMP-456]
2025-12-01 15:06:02.566 | DEBUG    | __main__:main:76 - Upserting record: {'date': '2025-06-05', 'campaign_id': 'CAMP-789', 'spend': 11, 'conversions': None, 'CPA': None}
2025-12-01 15:06:02.567 | DEBUG    | handler_DB.operations:upsert:40 - Upsert called with data: {'date': '2025-06-05', 'campaign_id': 'CAMP-789', 'spend': 11, 'conversions': None, 'CPA': None}
2025-12-01 15:06:02.576 | INFO     | handler_DB.operations:upsert:57 - Upsert successful [date=2025-06-05, campaign_id=CAMP-789]
2025-12-01 15:06:02.578 | DEBUG    | __main__:main:76 - Upserting record: {'date': '2025-06-06', 'campaign_id': 'CAMP-888', 'spend': None, 'conversions': 7, 'CPA': None}
2025-12-01 15:06:02.579 | DEBUG    | handler_DB.operations:upsert:40 - Upsert called with data: {'date': '2025-06-06', 'campaign_id': 'CAMP-888', 'spend': None, 'conversions': 7, 'CPA': None}
2025-12-01 15:06:02.588 | INFO     | handler_DB.operations:upsert:57 - Upsert successful [date=2025-06-06, campaign_id=CAMP-888]
2025-12-01 15:06:02.589 | DEBUG    | __main__:main:76 - Upserting record: {'date': '2025-06-06', 'campaign_id': 'CAMP-999', 'spend': 5.25, 'conversions': None, 'CPA': None}
2025-12-01 15:06:02.590 | DEBUG    | handler_DB.operations:upsert:40 - Upsert called with data: {'date': '2025-06-06', 'campaign_id': 'CAMP-999', 'spend': 5.25, 'conversions': None, 'CPA': None}
2025-12-01 15:06:02.599 | INFO     | handler_DB.operations:upsert:57 - Upsert successful [date=2025-06-06, campaign_id=CAMP-999]
2025-12-01 15:06:02.601 | DEBUG    | handler_DB.operations:query_by_date:68 - Querying daily_stats for date: 2025-06-02 00:00:00
2025-12-01 15:06:02.607 | INFO     | handler_DB.operations:query_by_date:72 - Found 0 records for date 2025-06-02 00:00:00
2025-12-01 15:06:02.608 | INFO     | __main__:main:84 - === Program finished successfully ===
